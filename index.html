<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="keywords" content="C, C++, automatic, tests, checker" />
  <meta name="description" content="An automatic generator of basic unit tests for a shared C/C++ library" />
  <title>API Sanity Checker</title>

  <style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: #deeef7;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; color: #211108; margin-bottom: 3px;margin-top:0px;padding-top:0px;}
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #211108; }
    h3 { text-align: center; color: #211108; }
    a { color: #211108; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre {padding: 0px;margin: 0px;padding-left: 10px;word-wrap:break-word;white-space: pre-wrap;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
    .code {border: dashed 1px gray; background-color: #f0f0f0;}
    .listing {padding: 10px;border: 1px solid black;width: 70%;font-family:"DejaVu Sans Mono", "Monaco", "Courier New", monospace;font-size:14px;}
    .summary {border:1px solid black;border-collapse:collapse;}
    table.summary td, table.summary th {border:1px solid black;padding:2px;}
  </style>

</head>

<body>
  <a href="https://github.com/lvc/api-sanity-checker"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

  <div id="container">

    <div class="download">
      <a href="https://github.com/lvc/api-sanity-checker/zipball/master">
        <img style="border: 0;" width="90" src="https://github.com/images/modules/download/zip.png" alt="" /></a>
      <a href="https://github.com/lvc/api-sanity-checker/tarball/master">
        <img style="border: 0;" width="90" src="https://github.com/images/modules/download/tar.png" alt="" /></a>
    </div>
   
    <h1>API Sanity Checker</h1>

    <div class="description">
      An automatic generator of basic unit tests for a shared C/C++ library
    </div>

    
      <p/>
      API Sanity Checker is an automatic generator of basic unit tests for a shared C/C++ library. It is able to generate reasonable (in most, but unfortunately not all, cases) input data for parameters and compose simple ("sanity" or "shallow"-quality) test cases for every function in the API through the analysis of declarations in header files.
      
      <p/>
      The quality of generated tests allows to check absence of critical errors in simple use cases. The tool is able to build and execute generated tests and detect crashes (segfaults), all kinds of emitted signals, non-zero program return code and program hanging.
      
      <p/>
      It may be considered as a tool for out-of-the-box low-cost sanity checking (fuzzing) of the library API or as a test development framework for initial generation of templates for advanced tests. Also it supports universal T2C format of tests, random test generation mode, specialized data types and other useful features.
      
      <p/>
      The tool is developed by Andrey Ponomarenko: <a href='https://abi-laboratory.pro/'>https://abi-laboratory.pro/</a>

<table class='summary'><tr><td>
<div>Table of Contents</div>
<ul>
<li><a href="#Downloads">Downloads</a></li>
<li><a href="#License">License</a></li>
<li><a href="#Supported_Platforms">Supported Platforms</a></li>
<li><a href="#Dependencies">Dependencies</a></li>
<li><a href="#Installation">Installation</a></li>
<li><a href="#Usage">Usage</a></li>
<li><a href="#Examples">Examples</a></li>
<li><a href="#Detectable">Detectable Problems</a></li>
<li><a href="#Spectypes">Specialized Types</a></li>
<li><a href="#Tutorial">Tutorial</a></li>
<li><a href="#How">How the Tool Works</a></li>
<li><a href="#Bugs">Bugs</a></li>
<li><a href="#Maintainers">Maintainers</a></li>
<li><a href="#ChangeLog">Changes</a></li>
<li><a href="#Articles">Articles</a></li>
</ul>
</td></tr></table>

<a name="Downloads"></a>
<h2>Downloads</h2>
<p>All releases can be downloaded from <a href="https://github.com/lvc/api-sanity-checker/">this page</a>.</p>

<p>Latest release: <a href="https://github.com/lvc/api-sanity-checker/archive/1.98.7.tar.gz">api-sanity-checker-1.98.7.tar.gz</a></p>

<p>Read-only access to the latest development version:</p>

<code class='code'>&nbsp;git clone git://github.com/lvc/api-sanity-checker&nbsp;</code>

<a name="License"></a>
<h2>License</h2>
<p>This program is free software. You may use, redistribute and/or modify it under the terms of the <a href="http://www.gnu.org/licenses/">GNU GPL</a> or <a href="http://www.gnu.org/licenses/">GNU LGPL</a></p>

<a name="Supported_Platforms"></a>
<h2>Supported Platforms</h2>
GNU/Linux, FreeBSD, Mac OS X.
    
<a name="Dependencies"></a>
<h2>Dependencies</h2>
<ul>
<li>
  <a href="https://github.com/lvc/abi-compliance-checker/">ABI Compliance Checker</a> (1.98.7 or newer)
</li>
<li>
  <a href="http://gcc.gnu.org/">G++</a> (3.0-4.7, recommended 4.5 or newer)
</li>
<li>
  <a href="http://www.gnu.org/software/binutils/">GNU Binutils</a> (readelf, c++filt, objdump)
</li>
<li>
  <a href="http://www.perl.org/">Perl 5</a> (5.8 or newer)
</li>
<li>
  <a href="http://ctags.sourceforge.net/">Ctags</a> (5.8 or newer)
</li>
</ul>

On Mac OS X it also requires Xcode for g++, c++filt, nm and otool.

<a name="Installation"></a>
<h2>Installation</h2>
<p>The tool is <b>ready-to-use</b> after extracting the archive.</p>

<p>You can also use a Makefile to install the tool into the system:</p>
<code class='code'>&nbsp;sudo make install prefix=PREFIX [/usr, /usr/local]&nbsp;</code>
<p>This command will install the <code>api-sanity-checker</code> program into the <code>PREFIX/bin</code> system directory and private modules into the <code>PREFIX/share</code>.</p>

<a name="Usage"></a>
<h2>Usage</h2>

For generating, building and running tests you should provide the <a href='Xml-Descriptor.html'>XML descriptor</a> for your library version. It is a simple XML-file that specifies version number, paths to header files and shared libraries and optionally some other information. An example of the descriptor is the following (0.3.4.xml):
<p/>
<div class='listing'>
<pre>
<span style='color:Green'>&lt;version&gt;</span>
    0.3.4
<span style='color:Green'>&lt;/version&gt;</span>

<span style='color:Green'>&lt;headers&gt;</span>
    /usr/local/libssh/0.3.4/include/
<span style='color:Green'>&lt;/headers&gt;</span>

<span style='color:Green'>&lt;libs&gt;</span>
    /usr/local/libssh/0.3.4/lib/
<span style='color:Green'>&lt;/libs&gt;</span>
</pre>
</div>
<p/>
Command to generate a test suite:
<p/>
<code class='code'>api-sanity-checker -lib NAME -d VER.xml -gen</code>
<p/>
You can view generated tests using the index file:
<p/>
<code class='code'>tests/NAME/VER/view_tests.html</code>
<p/>
or manually in the directory:
<p/>
<code class='code'>tests/NAME/VER/groups/</code>
<p/>
Command to build tests:
<p/>
<code class='code'>api-sanity-checker -l NAME -d VER.xml -build</code>
<p/>
Command to execute tests:
<p/>
<code class='code'>api-sanity-checker -l NAME -d VER.xml -run</code>
<p/>
The test report will be generated to:
<p/>
<code class='code'>test_results/NAME/VER/test_results.html</code>
<p/>

<a name="Examples"></a>
<h2>Examples</h2>
<table class='summary'>
<tr><th>Library</th><th>Version</th><th>Number of Tests</th><th>Problems Found</th></tr>
<tr>
<td>FreeType2</td>
<td>2.3.11</td>
<td><a href='http://upstream.rosalinux.ru/tests/freetype2/2.3.11/view_tests.html'>178</a></td>
<td><a href='http://upstream.rosalinux.ru/test_results/freetype2/2.3.11/test_results.html'>13</a></td>
</tr>
<tr>
<td>Glibc</td>
<td>2.13</td>
<td><a href='http://upstream.rosalinux.ru/tests/glibc/2.13/view_tests.html'>1996</a></td>
<td><a href='http://upstream.rosalinux.ru/test_results/glibc/2.13/test_results.html'>340</a></td>
</tr>
<tr>
<td>libX11</td>
<td>1.3.4</td>
<td><a href='http://upstream.rosalinux.ru/tests/libX11/1.3.4/view_tests.html'>778</a></td>
<td><a href='http://upstream.rosalinux.ru/test_results/libX11/1.3.4/test_results.html'>286</a></td>
</tr>
</table>

<a name="Detectable"></a>
<h2>Detectable Problems</h2>

<ul>
<li>
Crash (segfault, signal SEGV)
</li>
<li>
Abort (signal ABRT)
</li>
<li>
All emitted signals: FPE, BUS, ILL and others 
</li>
<li>
Non-zero exit code 
</li>
<li>
Program hanging 
</li>
<li>
Requirement failure (if specified) 
</li>
</ul>

<a name="Spectypes"></a>
<h2>Specialized Types</h2>
The specialized types are used to improve quality of generated tests. You can find more info <a href='Specialized-Type.html'>here</a>.

<a name="Tutorial"></a>
<h2>Tutorial</h2>
See the article at <a href="http://sourceware.org/glibc/wiki/Testing/Smoke_test">glibc wiki</a>.
<p/>

<a name="How"></a>
<h2>How the Tool Works </h2>
The basic idea of the test data generation algorithm is to recursively initialize parameters of a function using the values returned (or returned through the out-parameter) by other functions for structured data types (class, struct, union) or by some simple values for intrinsic data types (int, float, enum, ...). The recursion step includes the heuristic selection of the appropriate function, that should be called to initialize complex parameters for other functions. If some parameter of a function cannot be initialized, then the algorithm tries to select other function.
<p/>
Let's see the example test for "FT_Activate_Size( FT_Size size )" function from the FreeType2 library: 
<p/>

<div class='listing'>
<pre>
<span style='color:Green'>#include &lt;freetype/freetype.h&gt;</span>
<span style='color:Brown'>int</span> main(<span style='color:Brown'>int</span> argc, <span style='color:Brown'>char</span> *argv[])
{
    FT_Library alibrary = <span style='color:Blue'>0</span>;
    FT_Init_FreeType(&amp;alibrary); <span style='color:Gray'>//initialize "alibrary"</span>
    
    FT_Face face = <span style='color:Blue'>0</span>;
    FT_New_Face(
        alibrary,
        <span style='color:#FF00FF'>"sample.ttf"</span>,
        <span style='color:Blue'>0</span>,
        &amp;face); <span style='color:Gray'>//initialize "face"</span>
    
    FT_Size size = <span style='color:Blue'>0</span>;
    FT_New_Size(face, &amp;size); <span style='color:Gray'>//initialize "size"</span>
    
    <span style='color:Red'>FT_Activate_Size</span>(size); <span style='color:Gray'>//target call</span>
    return <span style='color:Blue'>0</span>;
}

</pre>
</div>

<p/>

In this test case the parameter "size" of target function FT_Activate_Size is initialized through the call of FT_New_Size function using its 2nd out-parameter. The first parameter "face" of FT_New_Size function is recursively initialized by the use of FT_New_Face function's 4th out-parameter. And finally the first parameter "alibrary" of FT_New_Face is initialized by the call of FT_Init_FreeType function on the 3rd recursion step. Other parameters of FT_New_Face function are initialized by intrinsic values. 

<a name="Bugs"></a>
<h2>Bugs</h2>
Please post your bug reports, feature requests and questions to the <a href="https://github.com/lvc/api-sanity-checker/issues">issue tracker</a>.
<p/>

<a name="Maintainers"></a>
<h2>Maintainers</h2>
The tool is developed by <a href="https://www.linkedin.com/in/andreyponomarenko">Andrey Ponomarenko</a>.

<a name="ChangeLog"></a>
<h2>Changes</h2>
You can find changelog <a href='Changelog.html'>here</a>.

<a name="Articles"></a>
<h2>Articles</h2>

<ul>
    <li>
        <a href='https://en.wikipedia.org/wiki/Sanity_check#Software_development'>"Sanity testing in software development"</a>, wikipedia.org
    </li>
    <li>
        <a href='https://en.wikipedia.org/wiki/Fuzz_testing'>"Fuzz testing"</a>, wikipedia.org
    </li>
    <li>
        <a href='http://panda.ispras.ru/~kuliamin/docs/AzovPrg-2008-en.pdf'>"Automation of broad sanity test generation"</a>, R. Zybin , V. Kuliamin , A. Ponomarenko , V. Rubanov and E. Chernov
    </li>
</ul>

<div class="footer">
    get the source code on GitHub : <a href="https://github.com/lvc/api-sanity-checker">lvc/api-sanity-checker</a>
</div>

<br/>
<br/>

</div>
</body>
</html>
